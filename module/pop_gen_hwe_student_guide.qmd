---
title: "Population Genetics"
date: "`r format(Sys.time(), '%B %d, %Y')`"
bibliography: ../book.bib
csl: ../resources/ieee-with-url.csl
format:
    html: default
---

Evolution is defined as a change in allele frequencies in a population over generations. Natural selection is one of the mechanisms driving these changes. Organisms with heritable traits that provide an advantage in a particular environment tend to survive longer and produce more offspring, causing those advantageous traits—and the alleles behind them—to become more common in the population.

However, natural selection is not the only way allele frequencies change. Genetic drift, migration, mutation, and environmental shifts also influence how populations evolve, sometimes in unpredictable ways.
Before working with quantitative models in the PopGen Fishbowl simulation, keep in mind:

- A trait is only advantageous in a specific environment.
- Mutations introduce new variation, which selection may or may not favor.
- Natural selection is not random, but drift is random.
- Environmental changes can reverse which alleles are beneficial.

In this activity, you will use a population genetics simulation to observe how allele frequencies shift through time and how natural selection, genetic drift, and migration can impact these frequencies.

# Introduction

_Microevolution_, or evolution on a small scale, is defined as a change in the frequency of gene variants, and alleles, in a population over generations. The field of biology that studies allele frequencies in populations and how they change over time is called _population genetics_.

Microevolution is sometimes contrasted with _macroevolution_, which is evolution that involves large changes, such as the formation of new groups or species, and happens over long time periods. However, most biologists view microevolution and macroevolution as the same process happening on different timescales. Microevolution adds up gradually, over long periods of time to produce macroevolutionary changes.

Let's look at three concepts that are core to the definition of microevolution: populations, alleles, and allele frequency.

A **population** is a group of organisms of the same species that are found in the same area and can interbreed. A population is the smallest unit that can evolve—in other words, an individual can’t evolve.

An **allele** is a version of a gene, a heritable unit that controls a particular feature of an organism.

For instance, Mendel studied a gene that controls flower color in pea plants. This gene comes in a white allele, w, and a purple allele, W. Each pea plant has two gene copies, which may be the same or different alleles. When the alleles are different, one—the dominant allele, W—may hide the other—the recessive allele, w. A plant's set of alleles, called its genotype, determines its phenotype, or observable features, in this case, flower color.

Coloration among many organisms, including koi fish (which you will be using in your simulation), is controlled by multiple genes. However, we can use some aspects of color patterns to model single gene inheritance patterns and evolution in populations. For example, the red or orange color in the Kohaku variety of koi can be treated as a codominant system. For the purposes of this simulations, a fish with the _RR_ genotype will be a solid red color, a fish with the _rr_ genotype will be white, and a fish with the _Rr_ genotype (the heterozygous genotype) will be white with red spots.

IMAGE

**Allele frequency** refers to how frequently a particular allele appears in a population. For instance, if all the alleles in a population of koi were red alleles, R, the allele frequency of W would be 100%, or 1.0. However, if half the alleles were R and half were r, each allele would have an allele frequency of 50%, or 0.5.

In general, we can define allele frequency as
_Allele frequency of A_ = ( Total number of A alleles in population) / (Number of copies A/a alleles in population)

Sometimes there are more than two alleles in a population (e.g., there might be A, a, and Ai alleles of a gene). In that case, you would want to add up all of the different alleles to get your denominator.

It's also possible to calculate genotype frequencies—the fraction of individuals with a given genotype—and phenotype frequencies—the fraction of individuals with a given phenotype. Keep in mind, though, that these are different concepts from allele frequency. We'll see an example of this difference next.

Let’s look at an example. Consider the very small population of nine koi fish shown below. Each fish has two copies of the color gene.

If we look at the two gene copies in each koi and count up how many R copies are present, we find there are 13. If we count up how many r copies are present, we find that there are five. The total number of gene copies in the whole population is 13 + 5 = 18.

We can divide the number of copies of each allele by the total number of copies to get the allele frequency. By convention, when there are just two alleles for a gene in a population, their frequencies are given the symbols p and q.

p = frequency of R = 13/18 = 0.72 or 72%
q = frequency of r = 5/18 = 0.28 or 28%

The frequencies of all the alleles of a gene must add up to one, or 100%.

Allele frequency is different from genotype frequency or phenotype frequency. Genotype and phenotype frequencies can also be calculated and are important for understanding how populations evolve, but they are not the same thing as allele frequency. The diagram below shows the difference.

IMAGE

Now, let’s suppose we come back a generation later and check the genotypes of the new koi fish that now make up the population. To find the allele frequencies, we again look at each individual’s genotype, count the number of copies of each allele, and divide by the total number of gene copies. Now, we find the frequency of R has dropped to 8/18 = 0.44 or 44%, and the frequency of r has risen to 10/18 = 0.56 or 56%.

There has been a change in allele frequencies in the population over generations, so—by the definition of microevolution—we can say that the population may have evolved. If we were actually doing research, we might want to use a statistical test (called a chi-square test) to confirm that these proportions were really different. 


The total set of gene copies for all genes in a population is referred to as its **gene pool**. The gene pool gets its name from the idea that we are essentially taking all the gene copies—for all genes—in the individuals of a population and dumping them into one large, common pool.

What would this look like? In the example above, we went through all nine individuals in the population and looked at their copies of the color gene. There were 18 individual gene copies, each of which was a R or a r allele. Imagine that we went through this same process for every gene in the koi fish, including genes that control length, number of whiskers, tail shape, metabolism, etc. There would be 18 copies of each gene pulled out and dumped into the common pool. At the end of this process, the common pool of gene copies will be the gene pool of our population.

By looking at all the copies of all the genes in a population, we can see globally how much genetic variation there is in the population. The more variation a population has, the better its ability to adapt to changes in its environment through natural selection. If there is more variation, the odds are better that there will be some alleles already present that allow organisms to survive and reproduce effectively under the new conditions.

But what ultimately interests most biologists is not the frequencies of different alleles, but the frequencies of the resulting genotypes, known as the **population’s genetic structure**, from which scientists can surmise the distribution of phenotypes. If the phenotype is observed, only the genotype of the homozygous recessive alleles can be known; the calculations provide an estimate of the remaining genotypes. Since each individual carries two alleles per gene, if the allele frequencies (p and q) are known, predicting the frequencies of these genotypes is a simple mathematical calculation to determine the probability of getting these genotypes if two alleles are drawn at random from the gene pool. 

So in the above scenario, an individual koi fish could be pp (YY), and thus produce yellow peas; pq (Yy), also yellow; or qq (yy), and thus producing green peas (Figure 19.2). In other words, the frequency of pp individuals is simply p2; the frequency of pq individuals is 2pq; and the frequency of qq individuals is q2. And, again, if p and q are the only two possible alleles for a given trait in the population, these genotype frequencies will sum to one: p2 + 2pq + q2 = 1.

## Hardy-Weinberg Equilibrium

In the early twentieth century, English mathematician Godfrey Hardy and German physician Wilhelm Weinberg stated the principle of equilibrium to describe the genetic makeup of a population. The theory, which later became known as the Hardy-Weinberg principle of equilibrium, states that a population’s allele and genotype frequencies are inherently stable— unless some kind of evolutionary force is acting upon the population, neither the allele nor the genotypic frequencies would change. 

The Hardy-Weinberg principle assumes conditions with:
- No mutations 
- No migration or emigration 
- No selective pressure for or against genotype 
- Large Sample Size 
- Random Mating 

In theory, if a population is at equilibrium — that is, there are no evolutionary forces acting upon it — generation after generation would have the same gene pool and genetic structure, and these equations would all hold true all of the time. Of course, even Hardy and Weinberg recognized that no natural population is immune to evolution. Populations in nature are constantly changing in genetic makeup due to drift, mutation, possibly migration, and selection. As a result, the only way to determine the exact distribution of phenotypes in a population is to go out and count them. But the Hardy-Weinberg principle gives scientists a mathematical baseline of a non-evolving population to which they can compare evolving populations and thereby infer what evolutionary forces might be at play. If the frequencies of alleles or genotypes deviate from the value expected from the Hardy-Weinberg equation, then the population is evolving.

::: callout-tip
No matter what genes you're working with, Hardy-Weinberg equilibrium uses standard symbols: p and q.

| HWE symbol  | What does it stand for? | What does this mean in my koi? |
|--------|--------|--------|
| p | Allele frequency of the dominant allele | frequency of R allele |
| q | Allele frequency of the recessive allele | frequency of r allele |
| p^2 | Genotypic frequency of the homozygous dominant | frequency of RR (red) koi |
| 2pq | Genotypic frequency of the heterozygous | frequency of Rr (spotted) koi |
| q^2 | Genotypic frequency of the homozygous recessive | frequency of rr (white) koi |

: Hardy-Weinberg Equilibrium symbols {.striped .hover}

:::

In this activity, you will use the PopGen Fishbowl online simulation to explore how populations evolve over time. Rather than working with real organisms (which would take generations to study), this model allows you to speed up time and watch how genetic drift and natural selection shape populations across dozens or even hundreds of generations. You will collect allele frequency data, analyze how evolutionary forces affect genetic variation, and compare different evolutionary scenarios.

The goal of this lab is to interpret patterns in allele frequencies and genotype frequencies under different conditions. By the end, you should be able to explain:
- how random events cause allele frequencies to drift,
- how selection favors certain alleles over others, and
- how a change in environment can shift which alleles are beneficial.

This activity reinforces what we discussed in lecture and provides a visual, dynamic way to observe evolution in action.

Click here to access the [PopGen Fishbowl Simulation](https://virtualbiologylab.org/ModelsHTML5/PopGenFishbowl/PopGenFishbowl.html).

In this activity, you will use the PopGen Fishbowl simulation to model three evolutionary processes:
1. Genetic Drift
2. Directional Natural Selection
3. Selection After an Environmental Change

Your goal is to observe how allele frequencies change over time and to explain why they change based on the evolutionary forces involved.

# Part 1: Modeling Hardy-Weinberg Equilibrium

RUN MODEL AT WITH 500 KOI. RECORD DATA AT 25, 50, 75, and 100 GENERATIONS. USE CHI-SQUARE TEST TO DETERMINE IF THE POPULATION IS AT HWE AT EACH GENERATION TIME POINT.
Use Excel to do a chi-square calculation?

RUN SIMULATION TWO MORE TIMES. WHAT ABOUT NOW? <- maybe let them see that while there’s some sampling error
Data Analysis and Conclusions
Based on your calculations are either of the populations in Hardy-Weinberg Equilibrium with respect to this particular gene?


# Part 2: Modeling Genetic Drift

In this first section, you will explore genetic drift, which is the random fluctuation of allele frequencies due to chance alone. No genotype has a fitness advantage in this model. You will run two trials: one with a large population and one with a small population.

## Trial 1. Population Size = 200 koi

Before running this simulation, change the settings to the following values.
- Initial size: 200 
- Carrying capacity: 200 
- Genotype Fitness: rr = 1.0, Rr = 1.0, RR = 1.0 
- Mutation (R→r, r→R): 0 
- Migration: 0 
- Assortative Mating: 0 
- Initial R Allele Proportion: 0.5 
- Mortality Rate: 10 
- Brood Size: 10 
- Sex Ratio: 0.5 

Run the model to 150 generations. You can speed this up since it’s a simulation!

| Generation  | Proportion R | Proportion r |
|--------|--------|--------|
| 0 | 0.5 | 0.5 |
| 75 | | |
| 150 |  |  |

**Make sure to take a screenshot of your Trial 1 fishbowl and Data Collection page at 150 generations - you will submit this with your assignment!**

## Trial 2: Population size = 25 koi

Before running this simulation, change the settings to the following values. The only parameters that have changed at the initial size and the carrying capacity.
- **Initial size: 25**
- **Carrying capacity: 25**
- Genotype Fitness: rr = 1.0, Rr = 1.0, RR = 1.0 
- Mutation (R→r, r→R): 0 
- Migration: 0 
- Assortative Mating: 0 
- Initial R Allele Proportion: 0.5 
- Mortality Rate: 10 
- Brood Size: 10 
- Sex Ratio: 0.5 

Run the model to 150 generations. You can speed this up since it’s a simulation!

| Generation  | Proportion R | Proportion r |
|--------|--------|--------|
| 0 | 0.5 | 0.5 |
| 75 | | |
| 150 |  |  |

**Make sure to take a screenshot of your Trial 2 fishbowl and Data Collection page at 150 generations - you will submit this with your assignment!**

## 

::: callout-tip
#Check your knowledge

1. Compare the change in allele frequencies between the large and small population. Which population changed more, and why?

2. Did either population approach fixation? (**Fixation** occurs when one allele reaches an allele frequency = 1) Explain why drift is more pronounced in small populations. 

3. Why do the two drift trials show different outcomes even with the same allele frequencies and equal fitness?

4. How does random sampling contribute to genetic drift over many generations?
:::

# Part 3: Modeling Natural Selection



Which population is not in Hardy-Weinberg? Which condition of Hardy-Weinberg is not being met?





 
Activity 1: Modeling Genetic Drift and Natural Selection

Part 1. Genetic Drift 
Part 2. Natural Selection
Here you will introduce natural selection by giving a fitness advantage to genotypes carrying the R allele.
Initial Size: 200
Carrying Capacity: 200
Genotype Fitness: rr = 0.5, Rr = 1.0, RR = 1.0
Mutation: 0
Migration: 0
Assortative Mating: 0
Initial R Allele Proportion: 0.5
Run the simulation until Generation 150 and record the following values:
Generation
Proportion R
Proportion r
0
 
 
75
 
 
150
 
 

INSERT SCREENSHOT OF FISHBOWL FOR Natural Selection at 150 generations
Directional Selection Analysis Questions
1. How did the allele frequencies change over the 150 generations when R was beneficial?





2. Why does the R allele increase in a predictable (non-random) pattern in this model?






3. What happened to the rr genotype over time, and why?






4. Compare this model to the drift-only model. What differences do you notice?






Part 3. Changing the Environment 
Now you will change the environment so that the r allele becomes advantageous while using the ending population from Part 2.
New Fitness Values:
rr = 1.0
Rr = 0.8
RR = 0.5
Run the simulation for another 150 generations and record the following values:
Generation
Proportion R
Proportion r
0
 
 
75
 
 
150
 
 


Environmental Change Analysis Questions
1. What happened to the R allele when the environment changed? Did the pattern follow drift or selection?






2. Explain why rr became the most common genotype by the end of the simulation.






3. How does this model illustrate that fitness depends on the environment?






4. Compare the two selection scenarios. How quickly did the population respond to environmental change?


“Allele Frequency and the Gene Pool” by Khan Academy licensed CC BY-NC-SA 4.0.


