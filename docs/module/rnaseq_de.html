<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GEMs - Differential Expression with RNA-seq</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XMR6CQ1L12"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XMR6CQ1L12', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">GEMs</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text"><strong>About</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../modules.html">
 <span class="menu-text">Modules</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#gut-brain-axis-autism-spectrum-disorder" id="toc-gut-brain-axis-autism-spectrum-disorder" class="nav-link active" data-scroll-target="#gut-brain-axis-autism-spectrum-disorder">Gut-brain axis: Autism Spectrum Disorder</a>
  <ul class="collapse">
  <li><a href="#the-mouse-as-a-model-organism" id="toc-the-mouse-as-a-model-organism" class="nav-link" data-scroll-target="#the-mouse-as-a-model-organism">The mouse as a model organism</a></li>
  <li><a href="#the-original-study" id="toc-the-original-study" class="nav-link" data-scroll-target="#the-original-study">The original study</a></li>
  <li><a href="#what-comparisons-can-i-make" id="toc-what-comparisons-can-i-make" class="nav-link" data-scroll-target="#what-comparisons-can-i-make">What comparisons can I make?</a></li>
  <li><a href="#learning-about-mouse-genes" id="toc-learning-about-mouse-genes" class="nav-link" data-scroll-target="#learning-about-mouse-genes">Learning about mouse genes</a>
  <ul class="collapse">
  <li><a href="#mouse-genome-database" id="toc-mouse-genome-database" class="nav-link" data-scroll-target="#mouse-genome-database">Mouse Genome Database</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#activity" id="toc-activity" class="nav-link" data-scroll-target="#activity">Activity</a>
  <ul class="collapse">
  <li><a href="#choose-your-dataset" id="toc-choose-your-dataset" class="nav-link" data-scroll-target="#choose-your-dataset">Choose your dataset</a>
  <ul class="collapse">
  <li><a href="#gut-brain-axis-autism-spectrum-disorder-in-mice" id="toc-gut-brain-axis-autism-spectrum-disorder-in-mice" class="nav-link" data-scroll-target="#gut-brain-axis-autism-spectrum-disorder-in-mice">Gut-brain axis: Autism Spectrum Disorder in mice</a></li>
  </ul></li>
  <li><a href="#loading-the-tidyverse-package-and-the-data" id="toc-loading-the-tidyverse-package-and-the-data" class="nav-link" data-scroll-target="#loading-the-tidyverse-package-and-the-data">Loading the tidyverse package and the data</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  <li><a href="#code-used-in-minicure-exercises" id="toc-code-used-in-minicure-exercises" class="nav-link" data-scroll-target="#code-used-in-minicure-exercises">Code used in miniCURE exercises</a>
  <ul class="collapse">
  <li><a href="#exploring-the-dataframe" id="toc-exploring-the-dataframe" class="nav-link" data-scroll-target="#exploring-the-dataframe">Exploring the dataframe</a></li>
  <li><a href="#summarizing-count-data" id="toc-summarizing-count-data" class="nav-link" data-scroll-target="#summarizing-count-data">Summarizing count data</a></li>
  <li><a href="#plotting-a-histogram" id="toc-plotting-a-histogram" class="nav-link" data-scroll-target="#plotting-a-histogram">Plotting a histogram</a></li>
  <li><a href="#filtering-out-a-specific-gene" id="toc-filtering-out-a-specific-gene" class="nav-link" data-scroll-target="#filtering-out-a-specific-gene">Filtering out a specific gene</a></li>
  <li><a href="#creating-a-gene-list" id="toc-creating-a-gene-list" class="nav-link" data-scroll-target="#creating-a-gene-list">Creating a gene list</a></li>
  <li><a href="#running-a-gene-set-analysis" id="toc-running-a-gene-set-analysis" class="nav-link" data-scroll-target="#running-a-gene-set-analysis">Running a gene set analysis</a></li>
  <li><a href="#plotting-a-single-gene-across-regions" id="toc-plotting-a-single-gene-across-regions" class="nav-link" data-scroll-target="#plotting-a-single-gene-across-regions">Plotting a single gene across regions</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Differential Expression with RNA-seq</strong></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This module is a companion and expansion to the C-MOOR RNA-seq miniCURE. You can find out more about the RNA-seq miniCURE and other C-MOOR activities at the <a href="https://www.c-moor.org/">C-MOOR website</a>. An online guide to the miniCURE is <a href="https://science.c-moor.org/miniCURE-RNA-seq/index.html">here</a>.</p>
<p>Each chapter introduces an RNA-seq dataset from a published research paper. The datasets have been formatted for student use.</p>
<section id="gut-brain-axis-autism-spectrum-disorder" class="level1">
<h1>Gut-brain axis: Autism Spectrum Disorder</h1>
<p>This dataset includes gene expression data from two different brain regions (striatum and prefrontal cortex) in mice. Mice in this experiment received fecal transplants. Some mice received transplants from humans who have been diagnosed with Autism Spectrum Disorder (ASD), while other mice received transplants from humans who did not have any diagnosis (control). This allowed researchers to control the composition of the gut microbiome in each mouse. Researchers then bred the mice and looked for differences in gene expression in the brains of the offspring.</p>
<section id="the-mouse-as-a-model-organism" class="level2">
<h2 class="anchored" data-anchor-id="the-mouse-as-a-model-organism">The mouse as a model organism</h2>
<p>The mouse is the most commonly-used model organism in laboratory work. In fact, mice and rats make up 95% of the lab animal population, and more than 80% of the research that has been awarded the Nobel Prize for Medicine was done at least in part with mouse models.</p>
<p>So what makes mice such good model organisms for biomedical research? Well, first, they’re economical and relatively easy to keep. Since mice are small, they don’t require a huge amount of space or food. They also have fast reproductive cycles, so researchers can study multiple generations within only a few years. Most importantly, though, mice and humans are both mammals and have about 85% of their protein-coding genome in common. As a result, mouse physiology is quite similar to human physiology. The mouse circulatory, reproductive, digestive, hormonal, and nervous systems are frequently used as models to study how humans grow, age, and develop chronic diseases. They are particularly important model organisms for cancer research and neuroscience.</p>
<p>You can find additional information about how the mouse is used in research <a href="https://www.google.com/url?q=https://www.informatics.jax.org/mgihome/other/homepage_IntroMouse.shtml">here!</a></p>
</section>
<section id="the-original-study" class="level2">
<h2 class="anchored" data-anchor-id="the-original-study">The original study</h2>
<p>The original study, <em>Gut Microbiota from Human Autism Spectrum Disorder Induces Behavioral Deficits in Mice</em>, was published in 2019. Gut microbiota are known to be different between individuals with ASD and individuals who are considered typically-developing. Additionally, some individuals with ASD also experience gastrointestinal symptoms, and their gut microbiota show the greatest difference when compared to the gut microbiota of typically-developing individuals. Some researchers have proposed that gut bacteria can influence some of the symptoms of ASD. The relationship between the intestinal microbiome and the development and function of the human brain is known as the <em>gut-brain axis.</em></p>
<p>In this study, researchers explored whether they could induce ASD-like behaviors in mice by changing their gut microbiome. They transplanted stool from either humans with ASD or controls into germ-free mice and discovered that colonization with gut microbiota was enough to induce ASD-like behaviors in the mice. They also let the mice breed and collected gene expression data from the brains of their offspring to explore whether changing the gut microbiota could result in changed gene expression. In particular, they discovered that the offspring of mice who received stool from ASD donors showed different gene splicing and expression profiles of certain ASD-relevant genes.</p>
<p>It is important to note that researchers are <strong>not</strong> suggesting that ASD is entirely induced by gut bacteria. There is a strong genetic component to ASD. Scientists have known for years that there are both genetic and environmental components to the development or severity of <strong>some</strong> ASD symptoms. This research explores one possible environmental component.</p>
<p>You can read the original research paper <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6993574/pdf/nihms-1528786.pdf">here</a>.</p>
</section>
<section id="what-comparisons-can-i-make" class="level2">
<h2 class="anchored" data-anchor-id="what-comparisons-can-i-make">What comparisons can I make?</h2>
<p>In this dataset, you have the option to look at gene expression in control vs ASD mice, as well as gene expression in both striatum and prefrontal cortex. All the mice were male and sacrificed at the same age (45 days).</p>
<p>Additionally, you can look at gene expression in striatum vs prefrontal cortex in only ASD mice or only control mice. Likewise, you also have the option of looking at gene expression in ASD and control mice, focusing only on striatum or only on prefrontal cortex.</p>
<p><em>Autism spectrum disorder</em> is a neurological disorder that affects behavioral and social interactions, among other things. Although ASD can be diagnosed at any age, it’s considered a neurodevelopmental disorder because symptoms usually show up within the first two years of life. Individuals diagnosed with ASD can experience a wide range of symptoms, including differences in social behaviors and communication styles, as well as intellectual disabilities and physical issues like sensory sensitivities or gastrointestinal problems.</p>
<p>The <em>striatum</em> is part of the brain involved in motor control and cognitive tasks like reward processing, decision-making, and social interactions (often called executive functions). It lies deep within the center of the brain and is composed of both gray matter (which can be thought of as the “processing” part of brain tissue) and white matter (which is the brain structure involved in transporting messages); the combination of the gray and white matter give this region of the brain a striped appearance, resulting in the name “striatum”. The striatum is involved in both reflexive movement - that is, involuntary movement that happens as an immediate response to a stimulus - and slower, planned movement like walking. In Parkinson’s disease, some patients experience degeneration of parts of the striatum, resulting in spastic, uncontrollable movement.</p>
<p>The <em>prefrontal cortex</em> is the part of the brain that is primarily in charge of decision making, reasoning, personality, maintaining social appropriateness, and other complex behaviors that fall under the umbrella of executive functions. This can include planning, self-control, and working towards long-term goals. The prefrontal cortex is located in the very front of the brain, just behind your forehead. One of the most famous brain injury patients was Phineas Gage, a railroad worker who survived an iron rod through his forehead. His prefrontal cortex was destroyed in this accident, and doctors noted huge behavioral and personality changes. You can read more about his case <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1114479/">here</a></p>
</section>
<section id="learning-about-mouse-genes" class="level2">
<h2 class="anchored" data-anchor-id="learning-about-mouse-genes">Learning about mouse genes</h2>
<p>In this dataset, genes are identified using their Ensembl Gene ID code. Every gene will have an ID that looks something like this:</p>
<p>ENSMUSG00000000001</p>
<p><strong>ENS</strong> stands for “Ensembl”. Ensembl is a genome database project managed by the European Bioinformatics Institute. It’s one of several databases like this. Others include NIH’s National Center for Biotechnology Information (NCBI; the organization that manages GenBank and PubMed) and the University of California, Santa Cruz (UCSC) Genome Browser. When a gene code starts with “ENS”, it means you should look up the gene code in the Ensembl database.</p>
<p><strong>MUS</strong> stands for “Mus”, which is the genus for the mouse.</p>
<p><strong>G</strong> stands for “Gene”. When you see “G” in the ID name, you know you are working with a gene. There are also codes for transcripts (“T”), exons (“E”), and proteins (“P”).</p>
<p><strong>00000000001</strong> is the numerical code associated with the gene.</p>
<p>You will need all four of these parts together to search for information about your mouse gene.</p>
<section id="mouse-genome-database" class="level3">
<h3 class="anchored" data-anchor-id="mouse-genome-database">Mouse Genome Database</h3>
<p>Just like FlyBase, there is a database that tracks mouse genes. This database is called <a href="https://www.informatics.jax.org/genes.shtml">Mouse Genome Informatics</a>. A full introduction to everything available through the MGI can be found <a href="https://www.informatics.jax.org/mgihome/other/homepage_usingMGI.shtml">here</a>. We’ll reproduce some of it below.</p>
<p>To look up information on a particular gene of interest, choose the “Genes” button.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_p.png" class="img-fluid figure-img" style="width:100.0%" alt="To look up information on a particular gene of interest, choose the “Genes” button."></p>
</figure>
</div>
</div>
</div>
<p>Next, type the gene ID into the “Search” bar up top. We’ll look up “ENSMUSG00000079516”.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g3412c9eee7c_0_1.png" class="img-fluid figure-img" style="width:100.0%" alt="Type the gene ID into the “Search” bar up top."></p>
</figure>
</div>
</div>
</div>
<p>After you type the gene ID into the Search bar and hit enter, you should see a new page with basic information about the gene. Click on the gene symbol (in this example, Reg3a) to get more detailed information.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g346083d4dc0_0_0.png" class="img-fluid figure-img" style="width:100.0%" alt="Click on the gene symbol (in this example, Reg3a) to get more detailed information."></p>
</figure>
</div>
</div>
</div>
<div class="{dictionary}">
<p>You might come across some unexpected terms when you search the MGI for your gene ID. In addition to genes, Ensembl gene IDs are also given to “pseudogenes”, “putative genes”, and “lncRNA”.</p>
<p><strong>pseudogene</strong>: This is a stretch of DNA that looks like a gene but doesn’t actually code for any protein products. It’s essentially a copy of a gene that contains mutations that prevent translation into a protein product. The mutations can include partial deletions, missing promoters, missing start codons, premature stop codons, frameshift mutations, or missing introns. Any of these are enough to result in a pseudogene.</p>
<p><strong>putative gene</strong>: This is a DNA segment that is believed to be a gene, but its function and protein product has not been confirmed. They are frequently identified based on the presence of an Open Reading Frame. Putative genes are not given names until they become confirmed genes.</p>
<p><strong>lncRNA</strong>: This stands for “long non-coding RNA”. lncRNA is a type of RNA molecule that is transcribed from DNA but does not code for proteins. These RNA molecules are at least 200-500 nucleotides long and play roles in various biological processes, like gene regulation.</p>
</div>
<p>On the new page that you open, details about the gene are organized into familiar categories. Down the left-hand side of the page, you will see sections about the chromosomal location, homology, gene ontology, expression data, and more. Most sections are expanded by default, but you’ll need to expand the “homology” section yourself.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g346083d4dc0_0_5.png" class="img-fluid figure-img" style="width:100.0%" alt="To look at gene homology, you’ll need to expand the “homology” section yourself."></p>
</figure>
</div>
</div>
</div>
<p>Once this section is expanded, you can find information about possible human homologs to the mouse gene, including alternate names and where the human homolog is located in the human genome.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g357f7ed062e_9_0.png" class="img-fluid figure-img" style="width:100.0%" alt="You can find information about possible human homologs to the mouse gene, including alternate names and where the human homolog is located in the human genome."></p>
</figure>
</div>
</div>
</div>
<p>If you continue scrolling down the page, you can also examine the pathways and processes the gene product is involved in under the “gene ontology” section. Clicking on the blue squares takes you to a page with more information about how that particular gene was assigned to a pathway or molecular process.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g346083d4dc0_0_11.png" class="img-fluid figure-img" style="width:100.0%" alt="If you continue scrolling down the page, you can also examine the pathways and processes the gene product is involved in under the “gene ontology” section."></p>
</figure>
</div>
</div>
</div>
<p>Directly underneath the “ontology” section is information about when the gene is expressed during development. You can learn more information by clicking on the blue squares, or by clicking on the links in the upper right-hand corner. These links will take you to other websites.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resources/images/rnaseq_de_files/figure-html//1vikcyml6uw-_DaC1yFpS-UWoWNEGxFukMB_eCi42BqY_g346083d4dc0_0_18.png" class="img-fluid figure-img" style="width:100.0%" alt="Directly underneath the “ontology” section is information about when the gene is expressed during development. You can learn more information by clicking on the blue squares, or by clicking on the links in the upper right-hand corner. These links will take you to other websites."></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="activity" class="level1">
<h1>Activity</h1>
<p>A separate Rmd file has been created for this activity. You can download it <a href="">here</a>. Once it’s downloaded, you should open it using RStudio.</p>
<section id="choose-your-dataset" class="level2">
<h2 class="anchored" data-anchor-id="choose-your-dataset">Choose your dataset</h2>
<p>You’ll first want to decide which dataset(s) you’ll use for your exploration.</p>
<section id="gut-brain-axis-autism-spectrum-disorder-in-mice" class="level3">
<h3 class="anchored" data-anchor-id="gut-brain-axis-autism-spectrum-disorder-in-mice">Gut-brain axis: Autism Spectrum Disorder in mice</h3>
<p><a href="https://drive.google.com/file/d/1RoDiq_D1YHVinmbuLRHCoGQ2wS8eWbB2/view?usp=sharing">Full gene expression data; no comparisons, just counts</a></p>
<p><strong>Comparing gene expression between ASD and control mice</strong></p>
<p><a href="https://drive.google.com/file/d/1IdtpRUcTpqCD41plaz9ddcow6V8ZtmEd/view?usp=sharing">Both brain regions</a></p>
<p><a href="https://drive.google.com/file/d/1IdtpRUcTpqCD41plaz9ddcow6V8ZtmEd/view?usp=sharing">Prefrontal cortex only</a></p>
<p><a href="https://drive.google.com/file/d/12yDb3-XvR49Gva-_s0jKN1Zdw5G7uRe-/view?usp=sharing">Striatum only</a></p>
<p><strong>Comparing gene expression between prefrontal cortex and striatum</strong></p>
<p><a href="https://drive.google.com/file/d/1A4eHpoarGjlGNC0mij-wrx9TAcFHmXn9/view?usp=sharing">All mice</a></p>
<p><a href="https://drive.google.com/file/d/1I4g5jEsHL1UnYkudcESWuvoF-DV-eO3s/view?usp=sharing">Only ASD mice</a></p>
<p><a href="https://drive.google.com/file/d/1dAzC4tOIRMqy9z749rh-hNEv3nV-6YpK/view?usp=sharing">Only control mice</a></p>
</section>
</section>
<section id="loading-the-tidyverse-package-and-the-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-tidyverse-package-and-the-data">Loading the tidyverse package and the data</h2>
<p>All the datasets for this activity can be loaded into R from their URL. In order to do this, we will use some code that has been saved in an R package called <code>tidyverse</code>. In order to use this code, we will need to install and open <code>tidyverse</code> using the R code chunk below.</p>
<p><code>install.packages</code> retrieves and installs the package</p>
<p><code>library</code> opens the package and makes the stored code available for you to use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you have installed and opened <code>tidyverse</code>, you should be ready to load the experimental data. You can do this using the <code>read_csv</code> command.</p>
<p>Let’s say you want to open one of the differential expression datasets and call it <code>dat</code>. The command would be:</p>
<p>dat &lt;- read_csv(“URL where the dataset is stored”)</p>
<p>Try it!</p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>Before starting this activity, you should have completed the miniCURE activities and identified genes of interest for your individual project. Remember, the basic steps of your analysis are:</p>
<ol type="1">
<li>Examine expression of your gene of interest expressed in this dataset.</li>
<li>Explore whether your gene of interest is differentially expressed in different experimental groups.</li>
<li>Characterize the genes that are differentially expressed between the experimental groups based on their molecular activity.</li>
</ol>
</section>
<section id="code-used-in-minicure-exercises" class="level2">
<h2 class="anchored" data-anchor-id="code-used-in-minicure-exercises">Code used in miniCURE exercises</h2>
<p>Here’s a quick overview of some of the code you used in the lab exercises!</p>
<section id="exploring-the-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-dataframe">Exploring the dataframe</h3>
<p>This lets you explore how the dataset is formatted and how big it is</p>
<p>head(readCounts) dim(readCounts)</p>
</section>
<section id="summarizing-count-data" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-count-data">Summarizing count data</h3>
<p>These commands allow you to run basic statistics on a variable (column) in the dataset</p>
<p>summary(readCounts<span class="math inline">\(V2) sum(readCounts\)</span>V2)</p>
</section>
<section id="plotting-a-histogram" class="level3">
<h3 class="anchored" data-anchor-id="plotting-a-histogram">Plotting a histogram</h3>
<p>A general histogram: hist(readCounts$V2, main=“Read Counts for Drosophila RNA-seq sample”)</p>
<p>A histogram with a log-transformed x-axis: hist(log10(readCounts$V2), main=“Log10 Read Counts for Drosophila RNA-seq sample”)</p>
<p>A histogram with a log-transformed x-axis and corrected zeros: hist(log10(readCounts$V2 + 0.1), main=“Log10 Read Counts for Drosophila RNA-seq sample with Zero Correction”)</p>
</section>
<section id="filtering-out-a-specific-gene" class="level3">
<h3 class="anchored" data-anchor-id="filtering-out-a-specific-gene">Filtering out a specific gene</h3>
<p>You might want to look at the expression of a specific gene</p>
<p>filter(readCounts_Cu, V1==“FBgn0002522”)</p>
</section>
<section id="creating-a-gene-list" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-gene-list">Creating a gene list</h3>
<p>In order to run gene set analyses, you will need to create a list of genes to look at. You can use the <code>filter</code> command to choose a p-value cut off. Make sure to check that your gene list has enough genes on it (and that you have a good ratio of “real” positive versus false positive results).</p>
<p>sig_genes &lt;- filter(a1_vs_p1, padj &lt;= 0.05) dim(sig_genes)</p>
</section>
<section id="running-a-gene-set-analysis" class="level3">
<h3 class="anchored" data-anchor-id="running-a-gene-set-analysis">Running a gene set analysis</h3>
<p>You can use the special command <code>runClusterProfiler</code> to figure out the types of processes genes on your gene list are involved in. You can also create a dotplot to visualize your results.</p>
<p>a1_vs_p1_clusters &lt;- runClusterProfiler(sig_genes)</p>
<p>dotplot(a1_vs_p1_clusters, showCategory=34, title=“a1 vs p1”, font.size=10, label_format = 50)</p>
</section>
<section id="plotting-a-single-gene-across-regions" class="level3">
<h3 class="anchored" data-anchor-id="plotting-a-single-gene-across-regions">Plotting a single gene across regions</h3>
<p>Finally, it might be interesting to look at the expression of a gene across all the possible regions. This is another special command that has been written for you.</p>
<p>plotAcrossRegions(“FBgn0000003”)</p>
<p>If you’re interested in plotting the genes with the lowest p-values, you can use the <code>arrange</code> command to sort the results first.</p>
<p>a1_vs_p1_sorted &lt;- arrange(a1_vs_p1, padj) head(a1_vs_p1_sorted)</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"></div>
  </div>
</footer>



</body></html>